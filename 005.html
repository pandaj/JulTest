<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Charmeleon</title>
</head>

<body>
<canvas id="canvas" width="50" height="50"></canvas>
<br>
<a href="javascript:void(0);" onClick="girar();">[ GIRAR ]</a><br>

<script type="text/javascript">
	var canvas = document.getElementById("canvas");
	var context = canvas.getContext("2d");
	
	var posX = 10; //posicion absoluta en X
	var posY = 10; // posicion absoluta en Y
	var width = 29; // ancho de cada sprite
	var height = 31; // alto de cada sprite
	var indica = 0; // indicador del sprite actual
	var tope = 4; // cantidad total de sprites
	var vel = 150; // velocidad de animacion
	var animaCirculo;
	
	//Creamos una funcion que se ejecutar√° al iniciar la ventana
	var img = new Image();
	
	img.onload = function() {
		limpieza();
		cambiaSprite();
		animaCirculo = setInterval(animaC, vel);
	}
	
	
	//ANIMAR SPRITES
	function cambiaSprite() {
		context.drawImage(img, (width*indica), 0, width, height, posX, posY, width, height);
		var imageData = context.getImageData(0, 0, canvas.width, canvas.height);
		var pixelArray = imageData.data;
		var length = pixelArray.length / 4;
		window.context.putImageData(imageData, 0, 0);
	}
	
	function limpieza() {
		context.clearRect(posX, posY, width, height);
	}
	
	function animaC() {
		var sumaGiro = tope * (indGiro - 1);
		
		if (indica == (tope * indGiro) - 1 ) {
			indica = sumaGiro;
		} else {
			indica += 1;
		}

		clearInterval(animaCirculo);
		animaCirculo = setInterval(animaC, vel);
		limpieza();
		cambiaSprite();
	}
	
	img.src = "005.png";
	
	
	//GIRAR SPRITES
	var indGiro = 1;
	
	function girar() {
		clearInterval(animaCirculo);
		if (indGiro == 4) {
			indGiro = 1;
		} else {
			indGiro++;
		}
		indica = tope * (indGiro - 1);
		
		limpieza();
		cambiaSprite();
		animaCirculo = setInterval(animaC, vel);
	}
</script>
</body>
</html>
